name: Simple Fix Typing

on:
  workflow_dispatch:

jobs:
  fix:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Fix firebase client
      run: |
        if [ -f "scripts/core/firebase_client.py" ]; then
          echo "Fixing firebase_client.py..."
          sed -i '1i from typing import Dict, Any, Optional' scripts/core/firebase_client.py
          echo "Fixed firebase_client.py"
        fi
    
    - name: Fix generate dashboard
      run: |
        if [ -f "scripts/generate_dashboard.py" ]; then
          echo "Fixing generate_dashboard.py..."
          sed -i '1i from typing import Dict, Any, List' scripts/generate_dashboard.py
          echo "Fixed generate_dashboard.py"
        fi
    
    - name: Fix main analyzer
      run: |
        if [ -f "scripts/main_analyzer.py" ]; then
          echo "Fixing main_analyzer.py..."
          sed -i '4i from typing import Dict, Any' scripts/main_analyzer.py
          echo "Fixed main_analyzer.py"
        fi
    
    - name: Test fix
      run: |
        cd scripts
        python -c "
import sys
sys.path.append('.')
try:
    from core.firebase_client import FirebaseClient
    print('Firebase client OK')
except Exception as e:
    print('Firebase client failed:', e)
try:
    from generate_dashboard import ModularDashboard
    print('Dashboard OK')
except Exception as e:
    print('Dashboard failed:', e)
        "
    
    - name: Commit changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add scripts/
        git commit -m "Fix typing imports" || echo "No changes"
        git push
